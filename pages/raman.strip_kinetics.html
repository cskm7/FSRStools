<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>raman.strip_kinetics &mdash; FSRStools 1.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/icon.ico"/>
    <link rel="top" title="FSRStools 1.1 documentation" href="../index.html" />
    <link rel="up" title="raman - Analysis of spontaneous and time-resolved Raman spectra" href="../raman.html" />
    <link rel="next" title="raman.TAFFT" href="raman.TAFFT.html" />
    <link rel="prev" title="raman.plotTA" href="raman.plotTA.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="raman.TAFFT.html" title="raman.TAFFT"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="raman.plotTA.html" title="raman.plotTA"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">FSRStools 1.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../raman.html" accesskey="U"><code class="docutils literal"><span class="pre">raman</span></code> - Analysis of spontaneous and time-resolved Raman spectra</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="raman.plotTA.html"
                        title="previous chapter">raman.plotTA</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="raman.TAFFT.html"
                        title="next chapter">raman.TAFFT</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/pages/raman.strip_kinetics.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="raman-strip-kinetics">
<h1>raman.strip_kinetics<a class="headerlink" href="#raman-strip-kinetics" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="raman.strip_kinetics">
<code class="descclassname">raman.</code><code class="descname">strip_kinetics</code><span class="sig-paren">(</span><em>y</em>, <em>Nmax=5</em>, <em>verbose=False</em>, <em>tryIRF=True</em>, <em>NyI=5</em>, <em>NyS=20</em>, <em>smooth=True</em><span class="sig-paren">)</span><a class="headerlink" href="#raman.strip_kinetics" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically remove slow kinetics from a (single) TA trace.
This function uses a minimal number of decaying / rising exponentials that may be convoluted with a Gaussian instrument response function to obtain the best fit to the slow kinetics.
Paremeters are determined automatically by choosing the feature set with the minimal chi2. Currently this function uses simple least squares curve fitting with bounds.
If y is a 2d array of TA traces, use every NyS-th row (and column) averaging over NyI rows to reconstruct a smooth TA. The result is subtracted from the original by cubic interpolation over the columns.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>array</em>) &#8211; The kinetics trace as function of time. May be a 2d array or list of traces with shape [time][wavelength] as, for example, returned by <a class="reference internal" href="raman.loadTA.html#raman.loadTA" title="raman.loadTA"><code class="xref py py-func docutils literal"><span class="pre">loadTA()</span></code></a>.</li>
<li><strong>Nmax</strong> (<em>int</em>) &#8211; The maximum number of exponentials to be used (default = 5).</li>
<li><strong>verbose</strong> (<em>bool</em>) &#8211; If True, print a list of fitting parameters used for fitting the kinetics trace (default = False).</li>
<li><strong>tryIRF</strong> (<em>bool</em>) &#8211; If True, also try exponentials convoluted with Gaussian, set to False if there is no step function in your data (default = True).</li>
<li><strong>NyI</strong> (<em>int</em>) &#8211; Number of rows to integrate for kinetics estimation. Used only for 2d TA traces (default = 5).</li>
<li><strong>NyS</strong> (<em>int</em>) &#8211; Number of rows/columns to skip for kinetics estimates. Must be &gt; NyI (default = 20).</li>
<li><strong>smooth</strong> (<em>bool</em>) &#8211; If True, apply denoise to the data for estimation of the kinetics. The returned residuum is not smoothed. For some data, however, denoise will not work properly, in which case it should be set to False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Stripped trace or list of traces (with same shape as y), ystripped, kinetics trace or list of kinetics traces (same shape as y), ykinetic.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">See <code class="xref py py-func docutils literal"><span class="pre">FSRStools.fitting.exponentials()</span></code> and <code class="xref py py-func docutils literal"><span class="pre">FSRStools.fitting.exp_gauss()</span></code> for details on the fitting functions.</p>
</div>
<p>The following example uses <code class="docutils literal"><span class="pre">strip_kinetics</span></code> to obtain a 2d Fourier map relating impulsively excited Raman modes with their position in the TA. See, for example, Musser et al., <em>Nat. Phys.</em> <strong>11</strong>, 352 (2015) for more details.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">FSRStools.raman</span> <span class="kn">as</span> <span class="nn">fs</span>

<span class="c"># y is a 2d TA map as loaded with loadTA(), wl is the wavelength axis, t is the time axis</span>
<span class="c"># first, strip the slow kinetics from the TA data</span>
<span class="n">ystr</span><span class="p">,</span> <span class="n">ykin</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">strip_kinetics</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c"># next, do an |FFT|**2 along the time axis to get the impulsive Raman spectrum</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft2</span><span class="p">(</span><span class="n">ystr</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,)))</span><span class="o">**</span><span class="mi">2</span>

<span class="c"># get the modes&#39; frequencies in cm-1</span>
<span class="n">wn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">d</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.9979e8</span> <span class="o">*</span> <span class="mf">1e-13</span><span class="p">)</span>

<span class="c"># now make a 2d plot using plotTA() - adjust the value of vmax to get a good contrast on the impulsive modes</span>
<span class="n">fs</span><span class="o">.</span><span class="n">plotTA</span><span class="p">(</span><span class="n">wn</span><span class="p">,</span> <span class="n">wl</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">showContour</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;Wavenumber (cm-1)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="raman.TAFFT.html" title="raman.TAFFT"
             >next</a> |</li>
        <li class="right" >
          <a href="raman.plotTA.html" title="raman.plotTA"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">FSRStools 1.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../raman.html" ><code class="docutils literal"><span class="pre">raman</span></code> - Analysis of spontaneous and time-resolved Raman spectra</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Daniel Dietze.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>